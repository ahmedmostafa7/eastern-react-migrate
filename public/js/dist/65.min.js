(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[65],{

/***/ "./src/app/components/inputs/fields/identifyWizard/fields.js":
/*!*******************************************************************!*\
  !*** ./src/app/components/inputs/fields/identifyWizard/fields.js ***!
  \*******************************************************************/
/*! exports provided: idtFields */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "idtFields", function() { return idtFields; });
const idtFields = [{
  name: "municipality",
  moduleName: "muns",
  label: "اختر البلدية",
  field: "select",
  required: true,
  label_key: "name",
  value_key: "code"
}, {
  name: "submunicipality",
  moduleName: "muns_sec",
  label: "اختر البلدية الفرعية",
  required: true,
  field: "select",
  label_key: "name",
  value_key: "code"
}, {
  name: "district",
  label: "اختر المنطقة",
  moduleName: "districts",
  field: "select",
  label_key: "attributes.DISTRICT_NAME",
  value_key: "attributes.DISTRICT_NAME_Code"
}, {
  name: "checks",
  label: "اختر الطبقات",
  field: "multiChecks",
  required: true
}, {
  name: "tableAdd",
  hideLabel: true,
  field: "gistTable",
  coulmns: [{
    title: "البلدية",
    dataIndex: "mun",
    key: "mun"
  }, {
    title: "البلدية الفرعية",
    dataIndex: "sub_mun",
    key: "sub_mun"
  }, {
    title: "الحي",
    dataIndex: "district",
    key: "district"
  }, {
    title: "الطبقات",
    dataIndex: "floors",
    key: "floors"
  }]
}, {
  name: "requested_file_type",
  moduleName: "requested_file_type",
  label: "اختر البلدية الفرعية",
  required: true,
  field: "select",
  data: [{
    label: "Shape",
    value: "Shape"
  }, {
    label: "CAD",
    value: "CAD"
  }, {
    label: "KML",
    value: "KML"
  }]
}];

/***/ }),

/***/ "./src/app/components/inputs/fields/identifyWizard/index.js":
/*!******************************************************************!*\
  !*** ./src/app/components/inputs/fields/identifyWizard/index.js ***!
  \******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var antd_lib_form_style__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! antd/lib/form/style */ "./node_modules/antd/lib/form/style/index.js");
/* harmony import */ var antd_lib_form_style__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(antd_lib_form_style__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var antd_lib_form__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! antd/lib/form */ "./node_modules/antd/lib/form/index.js");
/* harmony import */ var antd_lib_form__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(antd_lib_form__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/extends */ "./node_modules/@babel/runtime/helpers/extends.js");
/* harmony import */ var _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ "./node_modules/@babel/runtime/helpers/defineProperty.js");
/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _helpers_functions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../helpers/functions */ "./src/app/helpers/functions/index.js");
/* harmony import */ var redux_form__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! redux-form */ "./node_modules/redux-form/es/index.js");
/* harmony import */ var _identify_Component_common_esri_request__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../identify/Component/common/esri_request */ "./src/app/components/inputs/fields/identify/Component/common/esri_request.js");
/* harmony import */ var _identify_Component_common_common_func__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../identify/Component/common/common_func */ "./src/app/components/inputs/fields/identify/Component/common/common_func.js");
/* harmony import */ var _identify_Component_mapviewer_config_map__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../identify/Component/mapviewer/config/map */ "./src/app/components/inputs/fields/identify/Component/mapviewer/config/map.js");
/* harmony import */ var antd_dist_antd_css__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! antd/dist/antd.css */ "./node_modules/antd/dist/antd.css");
/* harmony import */ var antd_dist_antd_css__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(antd_dist_antd_css__WEBPACK_IMPORTED_MODULE_10__);
/* harmony import */ var _identify_Component_ThirdIdentifier_Helpers__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../identify/Component/ThirdIdentifier/Helpers */ "./src/app/components/inputs/fields/identify/Component/ThirdIdentifier/Helpers.js");
/* harmony import */ var _fields__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./fields */ "./src/app/components/inputs/fields/identifyWizard/fields.js");
/* harmony import */ var ___WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../.. */ "./src/app/components/inputs/index.js");















const layerAlias = {
  "حدود البلديه": "Municipality_Boundary",
  "حدود البلدية الفرعية": "Sub_Municipality_Boundary",
  "حدود التقسيم": "Subdivision",
  "حدود المخططات": "Plan_Data",
  "حدود االحياء": "District_Boundary",
  "حدود البلكات": "Survey_Block",
  "الراضي": "Landbase_Parcel",
  "الشوارع": "Street_Naming"
};
class IdentifyWizerd extends react__WEBPACK_IMPORTED_MODULE_4__["Component"] {
  constructor() {
    super();
    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_3___default()(this, "addResultTotable", () => {
      const floors = localStorage.getItem('floors');
      this.tableData = this.tableData || [];
      this.tableData.push({
        'mun': this.MUNICIPALITY_NAME,
        'sub_mun': this.subMun || '',
        'district': this.distrectname || '',
        floors: floors
      });
      this.fields[4].data2 = [...this.tableData];
      const {
        change
      } = this.props;
      change("identify.tableAdd", [...this.tableData]);
      console.log("this", change);
      this.setState({
        fields: this.fields
      });
    });
    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_3___default()(this, "Del", index => {
      let b = this.state.TableEle.filter((e, i) => i !== index);
      this.setState({
        TableEle: b
      });
      this.fields[4].del = b;
      this.setState({
        fields: this.fields
      });
    });
    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_3___default()(this, "onMunChange", e => {
      var _this$state$Municipal;
      this.SUB_MUNICIPALITY_NAME = null;
      this.SUB_MUNICIPALITY_code = null;
      this.distrectname = null;
      this.distrectcode = null;
      this.MUNICIPALITY_code = e;
      this.MUNICIPALITY_NAME = (_this$state$Municipal = this.state.MunicipalityNames) === null || _this$state$Municipal === void 0 ? void 0 : _this$state$Municipal.find(m => m.code == e).name;
      Object(_identify_Component_common_esri_request__WEBPACK_IMPORTED_MODULE_7__["esriRequest"])(_identify_Component_mapviewer_config_map__WEBPACK_IMPORTED_MODULE_9__["mapUrl"] + "/" + this.LayerID.Sub_Municipality_Boundary).then(response => {
        let subtypes = response.types.find(ele => ele.id === e).domains.SUB_MUNICIPALITY_NAME.codedValues;
        this.fields[1].data = subtypes;
        this.fields[1].onChange = this.onSubNameChange;
        this.MUNS_SEC = subtypes;
        this.setState({
          fields: this.fields
        });
      });
      Object(_identify_Component_common_common_func__WEBPACK_IMPORTED_MODULE_8__["queryTask"])({
        returnDistinctValues: true,
        ...Object(_identify_Component_ThirdIdentifier_Helpers__WEBPACK_IMPORTED_MODULE_11__["querySetting"])(this.LayerID.Landbase_Parcel, `MUNICIPALITY_NAME="${e}"`, false, ["DISTRICT_NAME"]),
        callbackResult: res => {
          Object(_identify_Component_common_common_func__WEBPACK_IMPORTED_MODULE_8__["getFeatureDomainName"])(res.features, this.LayerID.Landbase_Parcel).then(() => {
            this.setState({
              fields: this.fields
            });
          });
        }
      });
    });
    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_3___default()(this, "LayerBox", e => {
      const {
        change
      } = this.props;
      change('checks', e);
      this.LayersName = e;
      this.floors = e;
      this.layersid = e.map(h => this.LayerID[layerAlias[h]]);
    });
    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_3___default()(this, "DataTypeChange", e => {
      this.datatype = e;
    });
    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_3___default()(this, "onSubNameChange", e => {
      this.subMun = this.MUNS_SEC.find(d => d.code == e).name;
      Object(_identify_Component_common_common_func__WEBPACK_IMPORTED_MODULE_8__["queryTask"])({
        returnDistinctValues: true,
        ...Object(_identify_Component_ThirdIdentifier_Helpers__WEBPACK_IMPORTED_MODULE_11__["querySetting"])(this.LayerID.Landbase_Parcel, `SUB_MUNICIPALITY_NAME="${e}"`, false, ["DISTRICT_NAME"]),
        callbackResult: res => {
          Object(_identify_Component_common_common_func__WEBPACK_IMPORTED_MODULE_8__["getFeatureDomainName"])(res.features, this.LayerID.Landbase_Parcel).then(result => {
            this.fields[2].data = result;
            this.districtsNames = result;
            this.fields[2].onChange = this.onDistrictChange;
            // this.distrectname=result

            this.setState({
              fields: this.fields
            });
          });
        }
      });
    });
    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_3___default()(this, "onDistrictChange", e => {
      this.distrectname = this.districtsNames.find(d => d.attributes.DISTRICT_NAME_Code == e).attributes.DISTRICT_NAME;
      //  let dis = this.fields[2].data.find(m => m.code == e).name
      //  this.distrectname=names.DISTRICT_NAME
    });
    this.tableData = [];
    this.MUNS_SEC = [];
    this.districtsNames = [];
    this.floors = [];
    this.MUNICIPALITY_NAME = null;
    this.MUNICIPALITY_code = null;
    this.SUB_MUNICIPALITY_NAME = null;
    this.SUB_MUNICIPALITY_code = null;
    this.distrectname = null;
    this.distrectcode = null;
    this.LayersName = [];
    this.layersid = [];
    this.PlanNum = [];
    this.datatype = null;
    this.state = {
      fields: [],
      one: false,
      TableEle: [],
      munval: undefined,
      planeval: undefined,
      subTypeval: undefined,
      subNameval: undefined,
      subDivNames: [],
      MunicipalityNames: [],
      PlanNum: []
    };
    this.fields = _fields__WEBPACK_IMPORTED_MODULE_12__["idtFields"].map(f => Object(_helpers_functions__WEBPACK_IMPORTED_MODULE_5__["serverFieldMapper"])(f));
    Object(_identify_Component_common_common_func__WEBPACK_IMPORTED_MODULE_8__["getInfo"])().then(res => {
      this.LayerID = res;
      Object(_identify_Component_common_esri_request__WEBPACK_IMPORTED_MODULE_7__["esriRequest"])(_identify_Component_mapviewer_config_map__WEBPACK_IMPORTED_MODULE_9__["mapUrl"] + "/" + this.LayerID.Municipality_Boundary).then(response => {
        console.log(response);
        this.fields[3].LayerID = this.LayerID;
        this.fields[0].data = response.types[0].domains.MUNICIPALITY_NAME.codedValues;
        this.fields[0].onChange = this.onMunChange;
        this.fields[2].onChange = this.onDisChange;
        this.fields[3].act = this.LayerBox;
        this.fields[4].addResultTotable = this.addResultTotable;

        // this.fields[4].qw=this.state.TableEle
        // this.fields[3].options = this.plainOptions
        this.setState({
          fields: this.fields,
          MunicipalityNames: response.types[0].domains.MUNICIPALITY_NAME.codedValues
        });

        //this.setState({ MunicipalityNames: response.types[0].domains.MUNICIPALITY_NAME.codedValues })
      });
    });
  }
  componentDidMount() {
    Object(_identify_Component_common_common_func__WEBPACK_IMPORTED_MODULE_8__["getInfo"])().then(res => {
      this.LayerID = res;
      this.fields[3].LayerID = this.LayerID;
      // this.setState({ fields: this.fields })
      Object(_identify_Component_common_esri_request__WEBPACK_IMPORTED_MODULE_7__["esriRequest"])(_identify_Component_mapviewer_config_map__WEBPACK_IMPORTED_MODULE_9__["mapUrl"] + "/" + this.LayerID.Municipality_Boundary).then(response => {
        console.log(response);
        this.setState({
          MunicipalityNames: response.types[0].domains.MUNICIPALITY_NAME.codedValues
        });
      });
    });
    localStorage.clear();
  }
  render() {
    const {
      fields
    } = this.state;
    console.log(fields);
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(antd_lib_form__WEBPACK_IMPORTED_MODULE_1___default.a, null, fields && fields.map(field => {
      console.log("field", field);
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(redux_form__WEBPACK_IMPORTED_MODULE_6__["Field"], _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2___default()({
        key: field.name,
        name: field.name,
        component: ___WEBPACK_IMPORTED_MODULE_13__["default"]
      }, field));
    }));
  }
}
/* harmony default export */ __webpack_exports__["default"] = (IdentifyWizerd);

/***/ })

}]);
//# sourceMappingURL=65.min.js.map