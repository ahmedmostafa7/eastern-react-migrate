{"version":3,"file":"140.min.js","sources":["webpack:///./src/app/components/wizard/components/stepContent/sections/sectionTypes/wizardSummery/components/landData_allotment.js"],"sourcesContent":["import React, { Component } from \"react\";\r\nimport { host, filesHost } from \"config\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  convertToArabic,\r\n  localizeNumber,\r\n  getInfo,\r\n  remove_duplicate,\r\n  checkImage,\r\n  map_object,\r\n  project,\r\n} from \"../../../../../../../inputs/fields/identify/Component/common/common_func\";\r\nimport { esriRequest } from \"../../../../../../../inputs/fields/identify/Component/common/esri_request\";\r\nimport { mapUrl } from \"../../../../../../../inputs/fields/identify/Component/mapviewer/config/map\";\r\nimport { map, get, assign, isEmpty } from \"lodash\";\r\nimport { mapStateToProps, mapDispatchToProps } from \"../mapping\";\r\nimport {\r\n  Select,\r\n  Button,\r\n  Form,\r\n  message,\r\n  Checkbox,\r\n  Tabs,\r\n  Collapse,\r\n  Pagination,\r\n  Tooltip,\r\n} from \"antd\";\r\nconst Panel = Collapse.Panel;\r\nconst x = {\r\n  width: \"50%\",\r\n};\r\nconst parcel_fields = [\r\n  { label: \"Submission parcels\", field: \"PARCEL_PLAN_NO\" },\r\n  { label: \"Submission parcel area\", field: \"PARCEL_AREA\", ext: \"م2\" },\r\n  { label: \"Plan Number\", field: \"PLAN_NO\" },\r\n  { label: \"BlockNo\", field: \"PARCEL_BLOCK_NO\" },\r\n  { label: \"District\", field: \"DISTRICT_NAME\" },\r\n  { label: \"SUBDIVISION_TYPE\", field: \"SUBDIVISION_DESCRIPTION\" },\r\n  { label: \"رمز الاستخدام\", field: \"USING_SYMBOL\" },\r\n];\r\nclass landData_allotment extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.parcel_fields_headers = {\r\n      SHATFA_NORTH_EAST_DIRECTION: \"شمال / شرق\",\r\n      SHATFA_NORTH_WEST_DIRECTION: \"شمال / غرب\",\r\n      SHATFA_SOUTH_EAST_DIRECTION: \"جنوب / شرق\",\r\n      SHATFA_SOUTH_WEST_DIRECTION: \"جنوب / غرب\",\r\n    };\r\n    this.parcel_fields_electric_headers = {\r\n      ELEC_NORTH_EAST_DIRECTION: \"شمال / شرق\",\r\n      ELEC_NORTH_WEST_DIRECTION: \"شمال / غرب\",\r\n      ELEC_SOUTH_EAST_DIRECTION: \"جنوب / شرق\",\r\n      ELEC_SOUTH_WEST_DIRECTION: \"جنوب / غرب\",\r\n    };\r\n  }\r\n  openPrint = () => {\r\n    // let id = this.props?.currentModule.CurrentStep?.id;\r\n    if (this.props.currentModule.record.request_no) {\r\n      const {\r\n        t,\r\n        mainObject: { submissionType },\r\n        currentModule: {\r\n          record: { id },\r\n        },\r\n      } = this.props;\r\n      let landDataTemp =\r\n        (this.props.mainObject.landData &&\r\n          this.props.mainObject.landData.landData) ||\r\n        {};\r\n\r\n      localStorage.setItem(\r\n        \"parcelsData\",\r\n        JSON.stringify(landDataTemp?.lands?.parcels)\r\n      );\r\n\r\n      window.open(printHost + \"/#/print_description_card/\" + id, \"_blank\");\r\n    } else {\r\n      const { setModal } = this.props;\r\n      setModal({\r\n        title: \"كارت الوصف\",\r\n        name: \"fda2\",\r\n        // id: id,\r\n        className: \"mo3yna_full\",\r\n        type: \"globalMo3yna\",\r\n        mo3aynaObject: this.props.mainObject,\r\n      });\r\n    }\r\n  };\r\n\r\n  exportParcelToGoogleMap(geometry) {\r\n    \r\n    var centerPoint = new esri.geometry.Polygon(geometry).getCentroid();\r\n    project([centerPoint], 4326, (res) => {\r\n      window.open(\r\n        `http://maps.google.com/maps?q=${res[0].y},${res[0].x}`,\r\n        \"_blank\"\r\n      );\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const { t, mainObject } = this.props;\r\n\r\n    let landData = mainObject?.landData?.landData || {};\r\n\r\n    //;\r\n    const {\r\n      treeNode: {\r\n        option: { module_id },\r\n      },\r\n    } = this.props;\r\n\r\n    return (\r\n      (landData?.lands?.parcels?.length && (\r\n        <>\r\n          <Collapse className=\"Collapse\" defaultActiveKey={[\"0\"]}>\r\n            <Panel\r\n              key={\"0\"}\r\n              header={`كارت الوصف`}\r\n              forceRender={true}\r\n              style={{ margin: \"5px\" }}\r\n            >\r\n              <div>\r\n                <table className=\"table table-bordered no-margin table-striped\">\r\n                  {landData.site_allotment_before && (\r\n                    <tr>\r\n                      <td>هذا الموقع لم يتم تخصيصه مسبقا</td>\r\n                      <td>\r\n                        <Checkbox\r\n                          checked={landData.site_allotment_before}\r\n                          disabled={true}\r\n                        />\r\n                      </td>\r\n                    </tr>\r\n                  )}\r\n                  <tr>\r\n                    <td>كارت الوصف</td>\r\n                    <td>\r\n                      <Button\r\n                        type=\"primary\"\r\n                        icon=\"print\"\r\n                        onClick={this.openPrint.bind(this)}\r\n                      >\r\n                        طباعة كارت الوصف\r\n                      </Button>\r\n                    </td>\r\n                  </tr>\r\n                </table>\r\n              </div>\r\n            </Panel>\r\n          </Collapse>\r\n          <Collapse className=\"Collapse\" defaultActiveKey={[\"0\"]}>\r\n            {landData?.lands?.parcels\r\n              .reduce((a, b) => {\r\n                if (a.find((f) => f.mun == b.munval.name) == undefined) {\r\n                  a = (a.length && [\r\n                    ...a,\r\n                    {\r\n                      mun: b?.munval?.name,\r\n                      data: landData?.lands?.parcels.filter(\r\n                        (parcel) => parcel?.munval?.code == b?.munval?.code\r\n                      ),\r\n                    },\r\n                  ]) || [\r\n                    {\r\n                      mun: b?.munval?.name,\r\n                      data: landData?.lands?.parcels.filter(\r\n                        (parcel) => parcel?.munval?.code == b?.munval?.code\r\n                      ),\r\n                    },\r\n                  ];\r\n                }\r\n                return a;\r\n              }, [])\r\n              .map((section, index) => (\r\n                <Panel\r\n                  key={index}\r\n                  header={`${section.mun}`}\r\n                  forceRender={true}\r\n                  style={{ margin: \"5px\" }}\r\n                >\r\n                  {section.data.map((parcel) => (\r\n                    <div>\r\n                      <table className=\"table table-bordered no-margin table-striped\">\r\n                        {parcel.planeval && (\r\n                          <tr>\r\n                            <td style={x}>{t(\"Plan Number\")}</td>\r\n                            <td>{localizeNumber(parcel.planeval.name)}</td>\r\n                          </tr>\r\n                        )}\r\n                        {parcel.subTypeval && (\r\n                          <tr>\r\n                            <td style={x}>{parcel.subTypeval.name}</td>\r\n                            <td>{parcel.subNameval.name}</td>\r\n                          </tr>\r\n                        )}\r\n                        {parcel.blockval && (\r\n                          <tr>\r\n                            <td style={x}>{t(\"BlockNo\")}</td>\r\n                            <td>{localizeNumber(parcel.blockval.name)}</td>\r\n                          </tr>\r\n                        )}\r\n                        {parcel.noOfParcels && (\r\n                          <tr>\r\n                            <td style={x}>{t(\"عدد الأراضي\")}</td>\r\n                            <td>{localizeNumber(parcel.noOfParcels)}</td>\r\n                          </tr>\r\n                        )}\r\n                        {parcel.selectedLands.length > 0 && (\r\n                          <tr>\r\n                            <td style={x}>الأراضي المختارة</td>\r\n                            <td>\r\n                              {(parcel.landData_type == 1 ||\r\n                                (parcel.landData_type == 2 &&\r\n                                  [91, 92].indexOf(module_id) != -1)) &&\r\n                                parcel.selectedLands.map((land) => (\r\n                                  <table className=\"table table-bordered no-margin table-striped\">\r\n                                    <tr>\r\n                                      <td>موقع الأرض على جوجل</td>\r\n                                      <td>\r\n                                        <button\r\n                                          className=\"btn add-btnT\"\r\n                                          onClick={this.exportParcelToGoogleMap.bind(\r\n                                            this,\r\n                                            land.geometry\r\n                                          )}\r\n                                        >\r\n                                          موقع المخطط على جوجل\r\n                                        </button>\r\n                                      </td>\r\n                                    </tr>\r\n                                    {parcel_fields.map(\r\n                                      (parcelField) =>\r\n                                        land.attributes[parcelField.field] && (\r\n                                          <tr>\r\n                                            <td>\r\n                                              {land.attributes[\r\n                                                parcelField.label\r\n                                              ] || t(parcelField.label)}{\" \"}\r\n                                              {parcelField.ext &&\r\n                                                localizeNumber(parcelField.ext)}\r\n                                            </td>\r\n                                            <td>\r\n                                              {localizeNumber(\r\n                                                land.attributes[\r\n                                                  parcelField.field\r\n                                                ]\r\n                                              )}{\" \"}\r\n                                              {parcelField.ext &&\r\n                                                localizeNumber(parcelField.ext)}\r\n                                            </td>\r\n                                          </tr>\r\n                                        )\r\n                                    )}\r\n\r\n                                    {module_id == 92 && (\r\n                                      <>\r\n                                        <tr>\r\n                                          <td>{t(\"North Description\")}</td>\r\n                                          <td>\r\n                                            {convertToArabic(\r\n                                              land.parcelData.north_desc\r\n                                            )}\r\n                                          </td>\r\n                                        </tr>\r\n                                        <tr>\r\n                                          <td>{t(\"North Length\")}</td>\r\n                                          <td>\r\n                                            {convertToArabic(\r\n                                              land.parcelData.north_length\r\n                                            )}\r\n                                          </td>\r\n                                        </tr>\r\n                                        <tr>\r\n                                          <td>{t(\"South Description\")}</td>\r\n                                          <td>\r\n                                            {convertToArabic(\r\n                                              land.parcelData.south_desc\r\n                                            )}\r\n                                          </td>\r\n                                        </tr>\r\n                                        <tr>\r\n                                          <td>{t(\"South Length\")}</td>\r\n                                          <td>\r\n                                            {convertToArabic(\r\n                                              land.parcelData.south_length\r\n                                            )}\r\n                                          </td>\r\n                                        </tr>\r\n                                        <tr>\r\n                                          <td>{t(\"East Description\")}</td>\r\n                                          <td>\r\n                                            {convertToArabic(\r\n                                              land.parcelData.east_desc\r\n                                            )}\r\n                                          </td>\r\n                                        </tr>\r\n                                        <tr>\r\n                                          <td>{t(\"East Length\")}</td>\r\n                                          <td>\r\n                                            {convertToArabic(\r\n                                              land.parcelData.east_length\r\n                                            )}\r\n                                          </td>\r\n                                        </tr>\r\n                                        <tr>\r\n                                          <td>{t(\"West Description\")}</td>\r\n                                          <td>\r\n                                            {convertToArabic(\r\n                                              land.parcelData.west_desc\r\n                                            )}\r\n                                          </td>\r\n                                        </tr>\r\n                                        <tr>\r\n                                          <td>{t(\"West Length\")}</td>\r\n                                          <td>\r\n                                            {convertToArabic(\r\n                                              land.parcelData.west_length\r\n                                            )}\r\n                                          </td>\r\n                                        </tr>\r\n                                        {land?.parcelShatfa &&\r\n                                          Object.keys(land?.parcelShatfa).map(\r\n                                            (key, index) => {\r\n                                              return (\r\n                                                <tr>\r\n                                                  <td>\r\n                                                    إتجاه الشطفة :{\" \"}\r\n                                                    {\r\n                                                      this\r\n                                                        .parcel_fields_headers[\r\n                                                        key\r\n                                                      ]\r\n                                                    }\r\n                                                  </td>\r\n                                                  {(land?.parcelShatfa[key] && (\r\n                                                    <td>\r\n                                                      {convertToArabic(\r\n                                                        land?.parcelShatfa[key]\r\n                                                      )}{\" \"}\r\n                                                      م{convertToArabic(2)}\r\n                                                    </td>\r\n                                                  )) || <td>بدون</td>}\r\n                                                </tr>\r\n                                              );\r\n                                            }\r\n                                          )}\r\n                                        {/* {land.parcelElectric && (\r\n                                          <>\r\n                                            <tr>\r\n                                              <td>\r\n                                                {t(\"مساحة غرفة الكهرباء\")}\r\n                                              </td>\r\n                                              <td>\r\n                                                {convertToArabic(\r\n                                                  land?.parcelElectric\r\n                                                    ?.electric_room_area\r\n                                                )}\r\n                                              </td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                              <td>{t(\"مكان غرفة الكهرباء\")}</td>\r\n                                              <td>\r\n                                                {convertToArabic(\r\n                                                  land?.parcelElectric\r\n                                                    ?.electric_room_place\r\n                                                )}\r\n                                              </td>\r\n                                            </tr>\r\n                                          </>\r\n                                        )} */}\r\n                                        {land?.parcelElectric &&\r\n                                          Object.keys(land?.parcelElectric).map(\r\n                                            (key, index) => {\r\n                                              return (\r\n                                                <tr>\r\n                                                  <td>\r\n                                                    إتجاه غرفة الكهرباء :{\" \"}\r\n                                                    {\r\n                                                      this\r\n                                                        .parcel_fields_electric_headers[\r\n                                                        key\r\n                                                      ]\r\n                                                    }\r\n                                                  </td>\r\n                                                  {(land?.parcelElectric[\r\n                                                    key\r\n                                                  ] && (\r\n                                                    <td>\r\n                                                      {convertToArabic(\r\n                                                        land?.parcelElectric[\r\n                                                          key\r\n                                                        ]\r\n                                                      )}{\" \"}\r\n                                                      م{convertToArabic(2)}\r\n                                                    </td>\r\n                                                  )) || <td>بدون</td>}\r\n                                                </tr>\r\n                                              );\r\n                                            }\r\n                                          )}\r\n                                      </>\r\n                                    )}\r\n                                  </table>\r\n                                ))}\r\n                            </td>\r\n                          </tr>\r\n                        )}\r\n                      </table>\r\n                    </div>\r\n                  ))}\r\n                </Panel>\r\n              ))}\r\n          </Collapse>\r\n        </>\r\n      )) || <></>\r\n    );\r\n  }\r\n}\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(withTranslation(\"labels\")(landData_allotment));\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AASA;AACA;AAEA;AAYA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AAeA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAKA;AAKA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAmCA;AAEA;AACA;AACA;AAIA;AACA;AAEA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AAGA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAGA;AAAA;AAMA;AACA;AAAA;AASA;AACA;AACA;AAAA;AAUA;AAAA;AAAA;AAGA;AAAA;AACA;AAGA;AACA;AACA;AAAA;AAAA;AAEA;AAGA;AACA;AACA;AAAA;AAAA;AAEA;AAEA;AACA;AACA;AAGA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAIA;AAAA;AAGA;AAAA;AAMA;AAAA;AAMA;AAAA;AAMA;AAAA;AAMA;AAAA;AAMA;AAAA;AAKA;AACA;AAGA;AAmGA;AAqBA;AA6BA;AAyBA;AAkBA;AACA;AAEA;;;;A","sourceRoot":""}