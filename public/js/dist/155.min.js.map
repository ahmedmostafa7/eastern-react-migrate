{"version":3,"file":"155.min.js","sources":["webpack:///./src/app/components/wizard/components/stepContent/sections/sectionTypes/wizardSummery/components/sub_info.js"],"sourcesContent":["import React, { Component } from \"react\";\r\nimport { host, filesHost } from \"config\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {\r\n  convertToArabic,\r\n  localizeNumber,\r\n  getInfo,\r\n  remove_duplicate,\r\n  checkImage,\r\n  map_object,\r\n  project,\r\n  updateStatisticParcels,\r\n} from \"../../../../../../../inputs/fields/identify/Component/common/common_func\";\r\nimport { esriRequest } from \"../../../../../../../inputs/fields/identify/Component/common/esri_request\";\r\nimport { mapUrl } from \"../../../../../../../inputs/fields/identify/Component/mapviewer/config/map\";\r\nimport { map, get, assign, isEmpty } from \"lodash\";\r\nimport { mapStateToProps, mapDispatchToProps } from \"../mapping\";\r\nimport { connect } from \"react-redux\";\r\nimport { workFlowUrl } from \"../../../../../../../../../imports/config\";\r\nimport { setPlanDefaults } from \"../../../../../../../../../apps/modules/tabs/tableActionFunctions/mappingObjects/plan_approval/planDefaults\";\r\nclass allAttachments extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    const {\r\n      mainObject,\r\n      treeNode: { currentStepInfo },\r\n    } = props;\r\n\r\n    // if (mainObject?.plans?.plansData?.planDetails) {\r\n    //   mainObject.plans.plansData.planDetails.statisticsParcels =\r\n    //     updateStatisticParcels(\r\n    //       mainObject?.plans?.plansData?.planDetails.uplodedFeatures?.[\r\n    //         mainObject?.plans?.plansData?.planDetails.selectedCADIndex || 0\r\n    //       ],\r\n    //       mainObject?.plans?.plansData?.planDetails,\r\n    //       mainObject\r\n    //     );\r\n    // }\r\n    setPlanDefaults(mainObject);\r\n\r\n    this.state = {\r\n      mainObject: mainObject,\r\n    };\r\n    // statisticsParcels = updateStatisticParcels(\r\n    //   selectedPlan,\r\n    //   planDetails,\r\n    //   this.props.mainObject\r\n    // );\r\n  }\r\n\r\n  exportParcelToGoogleMap() {\r\n    const { mainObject } = this.props;\r\n    let graphics = mainObject.data_msa7y.msa7yData.mapviewer.mapGraphics\r\n      .map((layer) => layer.graphics)\r\n      .reduce((a, b) => {\r\n        b.forEach((graphic) => {\r\n          if (\r\n            graphic?.symbol?.type == \"esriTS\" &&\r\n            (graphic?.geometry.x == \"NaN\" || graphic?.geometry.y == \"NaN\")\r\n          ) {\r\n          } else {\r\n            a.push(graphic);\r\n          }\r\n        });\r\n        return a;\r\n      }, [])\r\n      .map((graphic) => new esri.Graphic(graphic));\r\n    \r\n    var centerPoint = esri.graphicsExtent(graphics).getExtent().getCenter();\r\n    project([centerPoint], 4326, (res) => {\r\n      window.open(\r\n        `http://maps.google.com/maps?q=${res[0].y},${res[0].x}`,\r\n        \"_blank\"\r\n      );\r\n    });\r\n  }\r\n  render() {\r\n    const {\r\n      treeNode: { currentStepInfo },\r\n    } = this.props;\r\n    const { mainObject } = this.state;\r\n    // let parcelsCount =\r\n    //   mainObject?.plans?.plansData?.planDetails?.detailsParcelTypes\r\n    //     ?.filter(\r\n    //       (r) =>\r\n    //         r.key == \"سكنى\" ||\r\n    //         r.key == \"استثماري\" ||\r\n    //         r.key == \"صناعى\" ||\r\n    //         r.key == \"زراعي\" ||\r\n    //         r.key == \"تجارى\"\r\n    //     )\r\n    //     ?.reduce((a, b) => {\r\n    //       return a + b?.value?.[0]?.value?.length;\r\n    //     }, 0) ||\r\n    //   mainObject?.plans?.plansData?.planDetails?.detailsParcelTypes?.reduce(\r\n    //     (a, b) => {\r\n    //       return (\r\n    //         a +\r\n    //         b?.value?.[0]?.value?.filter(\r\n    //           (r) =>\r\n    //             r.typeName == \"سكنى\" ||\r\n    //             r.typeName == \"استثماري\" ||\r\n    //             r.typeName == \"صناعى\" ||\r\n    //             r.typeName == \"زراعي\" ||\r\n    //             r.typeName == \"تجارى\"\r\n    //         )?.length\r\n    //       );\r\n    //     },\r\n    //     0\r\n    //   );\r\n    let plan_using_type = get(\r\n      mainObject,\r\n      \"submission_data.mostafed_data.mo5tat_use\",\r\n      \"\"\r\n    );\r\n    let parcelsCount =\r\n      get(mainObject, \"parcelsCount\", 0) ||\r\n      mainObject?.plans?.plansData.planDetails.detailsParcelTypes\r\n        .filter(\r\n          (r) =>\r\n            r.key == \"سكنى\" ||\r\n            r.key == \"استثماري\" ||\r\n            r.key == \"صناعى\" ||\r\n            r.key == \"زراعي\" ||\r\n            r.key == \"تجارى\" ||\r\n            (plan_using_type == \"حكومي\" && r.key == \"خدمات حكومية\")\r\n        )\r\n        ?.reduce((a, b) => {\r\n          return a + b?.value?.[0]?.value?.length;\r\n        }, 0) ||\r\n      mainObject?.plans?.plansData.planDetails.detailsParcelTypes?.reduce(\r\n        (a, b) => {\r\n          return (\r\n            a +\r\n            b?.value?.[0]?.value?.filter(\r\n              (r) =>\r\n                r.typeName == \"سكنى\" ||\r\n                r.typeName == \"استثماري\" ||\r\n                r.typeName == \"صناعى\" ||\r\n                r.typeName == \"زراعي\" ||\r\n                r.typeName == \"تجارى\" ||\r\n                (plan_using_type == \"حكومي\" && r.typeName == \"خدمات حكومية\")\r\n            )?.length\r\n          );\r\n        },\r\n        0\r\n      );\r\n\r\n    let cutAreaPercentage = get(mainObject, \"cutAreaPercentage\", 0);\r\n    // mainObject?.plans?.plansData?.planDetails?.statisticsParcels\r\n    //   ?.find(function (x) {\r\n    //     return x.name == \"النسب التخطيطية\";\r\n    //   })\r\n    //   ?.areaPercentage?.toFixed(2);\r\n\r\n    let servicePercentage = get(mainObject, \"servicePercentage\", 0);\r\n    // mainObject?.plans?.plansData?.planDetails?.statisticsParcels\r\n    //   ?.filter((d) => {\r\n    //     return d.name?.indexOf(\"خدمات\") != -1;\r\n    //   })\r\n    //   ?.reduce((a, b) => {\r\n    //     return a + b?.areaPercentage;\r\n    //   }, 0)\r\n    //   ?.toFixed(2) || 0;\r\n\r\n    return (\r\n      <div>\r\n        <table className=\"table table-bordered\">\r\n          <tbody>\r\n            {mainObject?.ownerData?.ownerData?.entity?.name && (\r\n              <tr>\r\n                <td>اسم المالك</td>\r\n                <td>\r\n                  {convertToArabic(\r\n                    (mainObject.ownerData.ownerData.owners &&\r\n                      Object.keys(mainObject.ownerData.ownerData.owners)\r\n                        ?.map(\r\n                          (ownerKey) =>\r\n                            mainObject.ownerData.ownerData.owners[ownerKey].name\r\n                        )\r\n                        ?.join(\", \")) ||\r\n                      mainObject?.ownerData?.ownerData?.entity?.name ||\r\n                      \"\"\r\n                  )}\r\n                </td>\r\n              </tr>\r\n            )}\r\n            <tr>\r\n              <td>اسم البلدية</td>\r\n              <td>\r\n                {convertToArabic(\r\n                  mainObject?.landData?.landData?.municipality?.name\r\n                )}\r\n              </td>\r\n            </tr>\r\n            {mainObject?.data_msa7y?.msa7yData?.cadDetails?.suggestionsParcels\r\n              ?.reduce((a, b) => {\r\n                return a + +b.area;\r\n              }, 0)\r\n              ?.toFixed(2) != undefined && (\r\n              <tr>\r\n                <td>مساحة الأرض من الطبيعة</td>\r\n                <td>\r\n                  {convertToArabic(\r\n                    (\r\n                      mainObject?.data_msa7y?.msa7yData?.cadDetails?.suggestionsParcels?.reduce(\r\n                        (a, b) => {\r\n                          return a + +b.area;\r\n                        },\r\n                        0\r\n                      ) -\r\n                      (mainObject?.data_msa7y?.msa7yData?.cadDetails\r\n                        ?.cuttes_area || 0)\r\n                    )?.toFixed(2) + \" م2\"\r\n                  )}\r\n                </td>\r\n              </tr>\r\n            )}\r\n            <tr>\r\n              <td>نوع الاستخدام</td>\r\n              <td>\r\n                {convertToArabic(\r\n                  mainObject?.submission_data?.mostafed_data?.use_sumbol\r\n                )}\r\n              </td>\r\n            </tr>\r\n            {mainObject?.lagna_karar?.lagna_karar?.plan_number && (\r\n              <tr>\r\n                <td>رقم المخطط</td>\r\n                <td>\r\n                  {convertToArabic(\r\n                    mainObject?.lagna_karar?.lagna_karar?.plan_number\r\n                  )}\r\n                </td>\r\n              </tr>\r\n            )}\r\n            {cutAreaPercentage != 0 && !isEmpty(cutAreaPercentage) && (\r\n              <tr>\r\n                <td>النسبة التخطيطية</td>\r\n                <td>{convertToArabic(cutAreaPercentage)} %</td>\r\n              </tr>\r\n            )}\r\n            {servicePercentage != 0 && !isEmpty(servicePercentage) && (\r\n              <tr>\r\n                <td>نسبة الخدمات</td>\r\n                <td>{convertToArabic(servicePercentage)} %</td>\r\n              </tr>\r\n            )}\r\n            {parcelsCount != undefined && parcelsCount != \"\" && (\r\n              <tr>\r\n                <td>عدد قطع الأراضي</td>\r\n                <td>{convertToArabic(parcelsCount)}</td>\r\n              </tr>\r\n            )}\r\n            <tr>\r\n              <td>الخطوة الحالية</td>\r\n              <td>{this.props?.currentModule?.record?.CurrentStep?.name}</td>\r\n            </tr>\r\n            <tr>\r\n              <td>الخطوة التالية</td>\r\n              <td>\r\n                {this.props?.currentModule?.record?.CurrentStep?.next_step\r\n                  ?.name || currentStepInfo?.CurrentStep?.next_step?.name}\r\n              </td>\r\n            </tr>\r\n            {mainObject?.data_msa7y?.msa7yData?.mapviewer?.mapGraphics && (\r\n              <tr>\r\n                <td>موقع المخطط</td>\r\n                <td>\r\n                  <button\r\n                    className=\"btn add-btnT\"\r\n                    onClick={this.exportParcelToGoogleMap.bind(this)}\r\n                  >\r\n                    موقع المخطط على جوجل\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            )}\r\n            {(mainObject?.landData?.landData?.lands?.parcelData\r\n              ?.plans_approved_Image ||\r\n              mainObject?.landData?.landData?.lands?.parcelData\r\n                ?.approved_Image) != undefined && (\r\n              <tr>\r\n                <td>صورة المخطط</td>\r\n                <td>\r\n                  {checkImage(\r\n                    this.props,\r\n                    mainObject?.landData?.landData?.lands?.parcelData\r\n                      ?.plans_approved_Image ||\r\n                      mainObject?.landData?.landData?.lands?.parcelData\r\n                        ?.approved_Image,\r\n                    {}\r\n                  )}\r\n                </td>\r\n              </tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(withTranslation(\"labels\")(allAttachments));\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAUA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AAGA;AAAA;AACA;AAKA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AAIA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;AAYA;AACA;AACA;AAEA;AACA;AAYA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AA8BA;AACA;AASA;AACA;AA8DA;AACA;AAAA;AA6BA;AACA;AAEA;;;;A","sourceRoot":""}